% ============================================================================
% Chapter 11: Testing and Validation
% ============================================================================
\chapter{Testing and Validation}

\section{Testing Strategy}

The platform employs multiple testing approaches to ensure reliability and correctness.

\section{API Endpoint Testing}

\subsection{Health Check Validation}

\begin{lstlisting}[language=bash, caption={Health Check Test}]
$ curl http://localhost:5000/api/health

{
  "status": "healthy",
  "checks": {
    "elasticsearch": {"status": "healthy", "response_time_ms": 15.2},
    "mongodb": {"status": "healthy", "response_time_ms": 8.1},
    "redis": {"status": "healthy", "response_time_ms": 0.8},
    "logstash": {"status": "healthy", "response_time_ms": 12.5}
  },
  "system": {
    "cpu_percent": 12.5,
    "memory_percent": 42.3
  }
}
\end{lstlisting}

\subsection{Statistics Endpoint}

\begin{lstlisting}[language=bash, caption={Statistics API Test}]
$ curl http://localhost:5000/api/stats

{
  "total_logs": 50000,
  "error_count": 1250,
  "error_rate": 2.5,
  "avg_response_time_ms": 125.4,
  "logs_today": 5000
}
\end{lstlisting}

\section{Performance Metrics}

\subsection{Response Time Benchmarks}

\begin{table}[H]
\centering
\begin{tabular}{lrrr}
\toprule
\textbf{Endpoint} & \textbf{P50 (ms)} & \textbf{P90 (ms)} & \textbf{P99 (ms)} \\
\midrule
/api/health & 25 & 45 & 120 \\
/api/stats & 80 & 150 & 350 \\
/api/search & 120 & 280 & 650 \\
/api/logs & 95 & 180 & 420 \\
\bottomrule
\end{tabular}
\caption{API Response Time Percentiles}
\end{table}

\subsection{Throughput Testing}

\begin{table}[H]
\centering
\begin{tabular}{lr}
\toprule
\textbf{Metric} & \textbf{Value} \\
\midrule
Max requests/second & 250 \\
Concurrent connections & 100 \\
WebSocket clients & 50 \\
Log ingestion rate & 1000 logs/sec \\
\bottomrule
\end{tabular}
\caption{Throughput Benchmarks}
\end{table}

\section{Prometheus Metrics Validation}

\subsection{Metrics Endpoint Test}

\begin{lstlisting}[language=bash, caption={Prometheus Metrics Test}]
$ curl http://localhost:5000/metrics | grep http_requests

http_requests_total{endpoint="/",method="GET",status_code="200"} 150
http_requests_total{endpoint="/api/stats",method="GET",status_code="200"} 45
http_request_latency_seconds_bucket{endpoint="/api/stats",le="0.1"} 30
http_request_latency_seconds_bucket{endpoint="/api/stats",le="0.5"} 44
\end{lstlisting}

\section{Integration Tests}

\subsection{End-to-End File Upload}

\begin{enumerate}
    \item Upload CSV file via web interface
    \item Verify file appears in Files list
    \item Confirm Logstash processing in logs
    \item Search for uploaded logs in Elasticsearch
    \item Verify statistics updated on dashboard
\end{enumerate}

\subsection{Real-Time Streaming Test}

\begin{enumerate}
    \item Open Live logs page in browser
    \item Verify WebSocket connection (green indicator)
    \item Send test log via TCP: \texttt{echo '\{"level":"INFO"\}' | nc localhost 5050}
    \item Confirm log appears in real-time
    \item Test pause/resume functionality
    \item Verify filters work correctly
\end{enumerate}

\section{Load Testing Results}

\subsection{Concurrent User Simulation}

\begin{table}[H]
\centering
\begin{tabular}{lrrr}
\toprule
\textbf{Users} & \textbf{Avg Response (ms)} & \textbf{Error Rate} & \textbf{RPS} \\
\midrule
10 & 85 & 0\% & 115 \\
50 & 145 & 0\% & 220 \\
100 & 280 & 0.5\% & 195 \\
200 & 520 & 2.1\% & 165 \\
\bottomrule
\end{tabular}
\caption{Load Test Results}
\end{table}

\section{Service Health Monitoring}

\subsection{Uptime Metrics}

\begin{table}[H]
\centering
\begin{tabular}{lr}
\toprule
\textbf{Service} & \textbf{Uptime} \\
\midrule
Webapp & 99.9\% \\
Elasticsearch & 99.8\% \\
MongoDB & 99.9\% \\
Redis & 99.9\% \\
\bottomrule
\end{tabular}
\caption{Service Uptime (30-day period)}
\end{table}

\section{Validation Summary}

\begin{itemize}
    \item[$\checkmark$] All API endpoints respond correctly
    \item[$\checkmark$] Health checks return accurate status
    \item[$\checkmark$] Real-time streaming functional
    \item[$\checkmark$] File upload and processing works
    \item[$\checkmark$] Search returns relevant results
    \item[$\checkmark$] Prometheus metrics exposed correctly
    \item[$\checkmark$] Grafana dashboards display data
\end{itemize}
