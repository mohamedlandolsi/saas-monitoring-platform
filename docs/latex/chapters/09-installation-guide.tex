% ============================================================================
% Chapter 9: Installation and Deployment Guide
% ============================================================================
\chapter{Installation and Deployment Guide}

\section{Prerequisites}

\subsection{Required Software}

\begin{itemize}
    \item \textbf{Docker:} Version 20.10 or higher
    \item \textbf{Docker Compose:} Version 2.0 or higher
    \item \textbf{Git:} For cloning the repository
    \item \textbf{curl:} For testing endpoints (optional)
\end{itemize}

\subsection{System Requirements}

\begin{table}[H]
\centering
\begin{tabular}{lll}
\toprule
\textbf{Resource} & \textbf{Minimum} & \textbf{Recommended} \\
\midrule
CPU & 4 cores & 8 cores \\
RAM & 8 GB & 16 GB \\
Disk & 20 GB SSD & 50 GB SSD \\
\bottomrule
\end{tabular}
\caption{System Requirements}
\end{table}

\section{Installation Steps}

\subsection{Step 1: Clone the Repository}

\begin{lstlisting}[language=bash]
git clone https://github.com/mohamedlandolsi/saas-monitoring-platform.git
cd saas-monitoring-platform
\end{lstlisting}

\subsection{Step 2: Configure Environment}

\begin{lstlisting}[language=bash]
# Copy environment template
cp .env.example .env

# Edit configuration (optional)
nano .env
\end{lstlisting}

\subsection{Step 3: Start the Platform}

\begin{lstlisting}[language=bash]
# Start all services
docker compose up -d

# Monitor startup progress
docker compose logs -f
\end{lstlisting}

\subsection{Step 4: Verify Installation}

\begin{lstlisting}[language=bash]
# Check service health
docker compose ps

# Test health endpoint
curl http://localhost:5000/api/health

# Test metrics endpoint
curl http://localhost:5000/metrics
\end{lstlisting}

\section{Service Access URLs}

\begin{table}[H]
\centering
\begin{tabular}{lll}
\toprule
\textbf{Service} & \textbf{URL} & \textbf{Credentials} \\
\midrule
Web Application & http://localhost:5000 & - \\
Elasticsearch & http://localhost:9200 & - \\
Kibana & http://localhost:5601 & - \\
Prometheus & http://localhost:9090 & - \\
Grafana & http://localhost:3000 & admin/admin123 \\
Jaeger & http://localhost:16686 & - \\
\bottomrule
\end{tabular}
\caption{Service URLs}
\end{table}

\section{Configuration Options}

\subsection{Environment Variables}

\begin{table}[H]
\centering
\begin{tabular}{ll}
\toprule
\textbf{Variable} & \textbf{Description} \\
\midrule
FLASK\_ENV & development or production \\
SECRET\_KEY & Flask secret key \\
ELASTICSEARCH\_HOST & ES connection URL \\
MONGODB\_URI & MongoDB connection string \\
REDIS\_HOST & Redis hostname \\
\bottomrule
\end{tabular}
\caption{Environment Variables}
\end{table}

\section{Stopping the Platform}

\begin{lstlisting}[language=bash]
# Stop all services
docker compose down

# Stop and remove volumes (data reset)
docker compose down -v
\end{lstlisting}

\section{Troubleshooting}

\subsection{Elasticsearch Won't Start}

\begin{lstlisting}[language=bash]
# Increase vm.max_map_count
sudo sysctl -w vm.max_map_count=262144
\end{lstlisting}

\subsection{Service Health Issues}

\begin{lstlisting}[language=bash]
# Check logs for specific service
docker compose logs elasticsearch
docker compose logs webapp

# Restart specific service
docker compose restart webapp
\end{lstlisting}
